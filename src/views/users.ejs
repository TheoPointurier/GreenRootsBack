<%- include('./partials/head.ejs') %>
  <%- include('./partials/header.ejs') %>
    <script src='/usersScript.js'></script>
    <script src='/searchBar.js'></script>

    <main>
      <div class="searchAddBar">
        <button class="create_button button" onclick="displayCreateUserModal()">Créer un nouvel utilisateur</button>
        <input type="text" class="searchInput" placeholder="Filtrer..." onkeyup="filterSearchBar()">
      </div>
      <div class="table_container table_container-users">
        <table>
          <thead>
            <tr>
              <th>Id</th>
              <th>Prénom</th>
              <th>Nom</th>
              <th>Email</th>
              <th>Téléphone</th>
              <th>Numéro de rue</th>
              <th>Rue</th>
              <th>Ville</th>
              <th>Code postal</th>
              <th>Pays</th>
              <th>Type d'entité</th>
              <th>Rôle</th>
              <th>Nom de l'entité</th>
              <th>SIRET</th>
              <th>Administrateur</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <% users.forEach(user=> { %>
              <tr>
                <td>
                  <%= user.id %>
                </td>
                <td>
                  <%= user.firstname %>
                </td>
                <td>
                  <%= user.lastname %>
                </td>
                <td>
                  <%= user.email %>
                </td>
                <td>
                  <%= user.phone_number %>
                </td>
                <td>
                  <%= user.street_number %>
                </td>
                <td>
                  <%= user.street %>
                </td>
                <td>
                  <%= user.city %>
                </td>
                <td>
                  <%= user.postal_code %>
                </td>
                <td>
                  <%= user.country %>
                </td>
                <td>
                  <%= user.role.name%>
                </td>
                <td>
                  <%= user.entity_type %>
                </td>
                <td>
                  <%= user.entity_name %>
                </td>
                <td>
                  <%= user.entity_siret %>
                </td>
                <td>
                  <%= user.is_admin %>
                </td>
                <td class="line-container-button">
                  <button onclick="displayEditUserModal('<%= user.id %>')" class="button save">Modifier</button>

                  <button onclick="displayDeleteUserModal('<%= user.id %>')" class="delete button">Supprimer</button>
                </td>
              </tr>


              <%- include('./partials/modals-updateUser.ejs', { user, roles }) %>
                <%- include('./partials/modals-deleteUser.ejs', {user}) %>
                  <% }) %>

          </tbody>
        </table>
      </div>
      <%- include('./partials/modals-createUser.ejs') %>

    </main>

    <%- include('./partials/footer.ejs') %>