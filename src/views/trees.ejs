<%- include('./partials/head.ejs') %>
  <%- include('./partials/header.ejs') %>
    <script src="/treesScript.js"></script>
    <script src='/searchBar.js'></script>
    <main>
      <div class="searchAddBar">
        <button class="create_button button" data-action="displayCreateTreeModal">Ajouter un nouvel arbre</button>
        <input type="text" class="searchInput" placeholder="Filtrer..." data-action="filterSearchBar">
      </div>
      <div class="table_container">
        <table>
          <thead>
            <tr>
              <th>Id</th>
              <th>Nom</th>
              <th>Prix HT</th>
              <th>Quantité</th>
              <th>Age (années)</th>
              <th>Espèce</th>
              <th>Description</th>
              <th>Absorption de CO2</th>
              <th>Durée de vie moyenne</th>
              <th>Campagne(s) associée(s)</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <% trees.forEach(tree=> { %>
              <tr>
                <td>
                  <%= tree.id %>
                </td>
                <td>
                  <%= tree.name %>
                </td>
                <td>
                  <%= tree.price_ht %>
                </td>
                <td>
                  <%= tree.quantity %>
                </td>
                <td>
                  <%= tree.age %>
                </td>
                <td>
                  <%= tree.species.species_name %>
                </td>
                <td>
                  <%= tree.species.description %>
                </td>
                <td>
                  <%= tree.species.co2_absorption %>
                </td>
                <td>
                  <%= tree.species.average_lifespan %>
                </td>
                <td>
                  <ul>
                    <% tree.campaignTree.forEach(campaign=> { %>
                      <li>
                        <%= campaign.name %>
                      </li>
                      <% }) %>
                  </ul>
                </td>
                <td class="line-container-button">
                  <button data-action="displayEditTreeModal" data-tree-id="<%= tree.id %>"
                    class="button save">Modifier</button>
                  <button data-action="displayDeleteTreeModal" data-tree-id="<%= tree.id %>"
                    class="delete button">Supprimer</button>
                </td>
              </tr>
              <%- include('./partials/modals-updateTree.ejs', { tree }) %>
                <%- include('./partials/modals-deleteTree.ejs', { tree }) %>
                  <% }) %>
          </tbody>

        </table>
      </div>
      <%- include('./partials/modals-createTree.ejs') %>
    </main>

    <%- include('./partials/footer.ejs') %>